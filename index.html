<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>몬스터 헌터 - 포켓 어드벤처</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <div id="game-container">
        <!-- 로그인 화면 -->
        <div id="login-screen" class="screen active">
            <h1 class="game-title">🎮 몬스터 헌터</h1>
            <p class="subtitle">포켓 어드벤처</p>
            <div class="login-buttons">
                <button onclick="signInWithGoogle()" class="google-btn">
                    <span class="google-icon">G</span>
                    Google로 로그인
                </button>
                <button onclick="playAsGuest()" class="guest-btn">
                    게스트로 플레이
                </button>
            </div>
            <p class="login-note">로그인하면 게임 데이터가 클라우드에 저장됩니다.</p>
        </div>

        <!-- 메인 메뉴 -->
        <div id="main-menu" class="screen">
            <div class="user-info" id="user-info">
                <span id="user-display-name">게스트</span>
                <button onclick="signOutUser()" id="logout-btn" class="small-btn">로그아웃</button>
            </div>
            <h1 class="game-title">🎮 몬스터 헌터</h1>
            <p class="subtitle">포켓 어드벤처</p>
            <div class="menu-buttons">
                <button onclick="startStoryMode()">스토리 모드</button>
                <button onclick="startExploreMode()">탐험 모드</button>
                <button onclick="showScreen('pokedex-screen')">도감</button>
                <button onclick="showMyPage()">👤 마이페이지</button>
            </div>
        </div>

        <!-- 이름 입력 화면 -->
        <div id="name-input-screen" class="screen">
            <div class="name-input-container">
                <h2>🌟 새로운 모험을 시작합니다!</h2>
                <p>당신의 이름은 무엇인가요?</p>
                <input type="text" id="player-name-input" maxlength="10" placeholder="이름을 입력하세요">
                <div class="gender-select">
                    <p>캐릭터를 선택하세요:</p>
                    <div class="gender-options">
                        <button class="gender-btn selected" data-gender="boy" onclick="selectGender('boy')">
                            <img src="images/player/player_boy_icon.png" alt="남자" class="gender-icon-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <span class="gender-icon" style="display:none;">👦</span>
                            <span>남자</span>
                        </button>
                        <button class="gender-btn" data-gender="girl" onclick="selectGender('girl')">
                            <img src="images/player/player_girl_icon.png" alt="여자" class="gender-icon-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <span class="gender-icon" style="display:none;">👧</span>
                            <span>여자</span>
                        </button>
                    </div>
                </div>
                <button onclick="confirmPlayerName()" class="confirm-btn">모험 시작!</button>
            </div>
        </div>

        <!-- 스토리 대화 화면 -->
        <div id="story-dialogue-screen" class="screen">
            <div class="dialogue-background" id="dialogue-background"></div>
            <div class="dialogue-container">
                <div class="dialogue-portrait" id="dialogue-portrait"></div>
                <div class="dialogue-box">
                    <div class="dialogue-speaker" id="dialogue-speaker">???</div>
                    <div class="dialogue-text" id="dialogue-text">대화 내용...</div>
                    <div class="dialogue-indicator">▼</div>
                </div>
            </div>
            <div class="dialogue-choices hidden" id="dialogue-choices">
                <!-- 선택지가 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 스타터 선택 화면 -->
        <div id="starter-select-screen" class="screen">
            <div class="starter-container">
                <h2>🎁 첫 번째 파트너를 선택하세요!</h2>
                <div class="starter-grid">
                    <div class="starter-card" onclick="selectStarter('flameling')">
                        <div class="starter-sprite">🔥</div>
                        <div class="starter-name">플레임링</div>
                        <div class="starter-type fire">불 속성</div>
                        <div class="starter-desc">뜨거운 열정을 가진 몬스터</div>
                    </div>
                    <div class="starter-card" onclick="selectStarter('aquapup')">
                        <div class="starter-sprite">🐳</div>
                        <div class="starter-name">아쿠아펍</div>
                        <div class="starter-type water">물 속성</div>
                        <div class="starter-desc">물 속에서 자유로운 몬스터</div>
                    </div>
                    <div class="starter-card" onclick="selectStarter('sproutie')">
                        <div class="starter-sprite">🌱</div>
                        <div class="starter-name">스프라우티</div>
                        <div class="starter-type grass">풀 속성</div>
                        <div class="starter-desc">햇빛을 사랑하는 몬스터</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 스토리 맵 화면 -->
        <div id="story-map-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('main-menu')">메뉴</button>
                <h2>🗺️ 월드 맵</h2>
                <span id="story-chapter">챕터 1</span>
            </div>
            <div class="story-map-container" id="story-map-container">
                <!-- 맵 위치들이 동적으로 추가됨 -->
            </div>
            <div class="bottom-nav">
                <button onclick="showMyPage()">👤 MY</button>
                <button onclick="showScreen('party-screen')">🐾 파티</button>
                <button onclick="showScreen('pokedex-screen')">📖 도감</button>
                <button onclick="showScreen('bag-screen')">🎒 가방</button>
                <button onclick="goToExploreFromStory()">🌍 탐험</button>
            </div>
        </div>

        <!-- 스토리 장소 화면 -->
        <div id="story-location-screen" class="screen">
            <div class="location-background" id="location-background"></div>
            <div class="location-header">
                <button class="back-btn" onclick="returnToStoryMap()">← 맵으로</button>
                <h2 id="location-name">장소 이름</h2>
            </div>
            <div class="location-description" id="location-description">
                장소 설명...
            </div>
            <div class="location-actions" id="location-actions">
                <!-- 장소별 행동 버튼들이 동적으로 추가됨 -->
            </div>
            <div class="location-npcs" id="location-npcs">
                <!-- NPC들이 동적으로 추가됨 -->
            </div>
            <div class="location-nav" id="location-nav">
                <!-- 이동 가능한 장소들이 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 탐험 화면 -->
        <div id="explore-screen" class="screen">
            <div class="top-bar">
                <div class="player-info">
                    <span id="player-name">트레이너</span>
                    <span class="player-level-badge" id="explore-player-level">Lv.1</span>
                    <span id="player-balls">🔴 x <span id="ball-count">10</span></span>
                </div>
                <button class="menu-btn" onclick="showScreen('main-menu')">메뉴</button>
            </div>
            <h2>🗺️ 탐험할 지역을 선택하세요</h2>
            <div class="auto-battle-toggle">
                <button id="auto-battle-btn" class="auto-battle-btn" onclick="toggleAutoBattle()">
                    🤖 자동 전투: <span id="auto-battle-status">OFF</span>
                </button>
            </div>
            <div class="region-grid" id="region-grid">
                <!-- 지역들이 동적으로 추가됨 -->
            </div>
            <div class="bottom-nav">
                <button onclick="showMyPage()">👤 MY</button>
                <button onclick="showScreen('party-screen')">🐾 파티</button>
                <button onclick="showScreen('pokedex-screen')">📖 도감</button>
                <button onclick="showScreen('bag-screen')">🎒 가방</button>
                <button onclick="goToStoryFromExplore()">📖 스토리</button>
            </div>
        </div>

        <!-- 배틀 화면 -->
        <div id="battle-screen" class="screen">
            <div class="battle-arena">
                <!-- 적 몬스터 -->
                <div class="enemy-side">
                    <div class="monster-info enemy-info">
                        <span id="enemy-name">???</span>
                        <span id="enemy-level">Lv.?</span>
                        <div class="hp-bar">
                            <div class="hp-fill" id="enemy-hp-bar"></div>
                        </div>
                        <span class="hp-text" id="enemy-hp-text">??/??</span>
                    </div>
                    <div class="monster-sprite" id="enemy-sprite"></div>
                </div>

                <!-- 내 몬스터 -->
                <div class="player-side">
                    <div class="monster-sprite" id="player-sprite"></div>
                    <div class="monster-info player-info">
                        <span id="player-monster-name">???</span>
                        <span id="player-monster-level">Lv.?</span>
                        <div class="hp-bar">
                            <div class="hp-fill" id="player-hp-bar"></div>
                        </div>
                        <span class="hp-text" id="player-hp-text">??/??</span>
                        <div class="exp-bar">
                            <div class="exp-fill" id="player-exp-bar"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 배틀 메시지 -->
            <div class="battle-message" id="battle-message">
                야생의 몬스터가 나타났다!
            </div>

            <!-- 배틀 메뉴 -->
            <div class="battle-menu" id="battle-menu">
                <button onclick="showSkills()">⚔️ 싸우기</button>
                <button onclick="showItemMenu()">🎒 아이템</button>
                <button onclick="showSwitchMenu()">🔄 교체</button>
                <button onclick="tryCapture()">🔴 포획</button>
                <button onclick="runAway()">🏃 도망</button>
            </div>

            <!-- 스킬 메뉴 -->
            <div class="skill-menu hidden" id="skill-menu">
                <!-- 스킬들이 동적으로 추가됨 -->
            </div>

            <!-- 아이템 메뉴 -->
            <div class="item-menu hidden" id="item-menu">
                <!-- 아이템들이 동적으로 추가됨 -->
            </div>

            <!-- 교체 메뉴 -->
            <div class="switch-menu hidden" id="switch-menu">
                <!-- 교체 가능한 몬스터들이 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 포획 애니메이션 -->
        <div id="capture-screen" class="screen">
            <div class="capture-animation">
                <div class="pokeball" id="pokeball">🔴</div>
                <div class="capture-message" id="capture-message">포획 중...</div>
            </div>
        </div>

        <!-- 진화 화면 -->
        <div id="evolve-screen" class="screen">
            <div class="evolve-animation">
                <div class="evolve-sprite" id="evolve-sprite">🔥</div>
                <div class="evolve-message" id="evolve-message">진화 중...</div>
            </div>
        </div>

        <!-- 도감 화면 -->
        <div id="pokedex-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="goBack()">← 뒤로</button>
                <h2>📖 몬스터 도감</h2>
                <span id="pokedex-progress">0/0</span>
            </div>
            <div class="pokedex-grid" id="pokedex-grid">
                <!-- 도감 항목들이 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 마이페이지 화면 -->
        <div id="mypage-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="goBack()">← 뒤로</button>
                <h2>👤 마이페이지</h2>
            </div>
            <div class="mypage-content">
                <!-- 프로필 카드 -->
                <div class="profile-card">
                    <div class="profile-avatar" id="profile-avatar">👦</div>
                    <div class="profile-info">
                        <h3 id="profile-name">트레이너</h3>
                        <div class="profile-level">
                            <span class="level-badge" id="profile-level">Lv. 1</span>
                            <span class="level-title" id="profile-title">초보 트레이너</span>
                        </div>
                    </div>
                </div>

                <!-- 경험치 바 -->
                <div class="player-exp-section">
                    <div class="exp-label">
                        <span>경험치</span>
                        <span id="profile-exp-text">0 / 100</span>
                    </div>
                    <div class="player-exp-bar">
                        <div class="player-exp-fill" id="profile-exp-bar"></div>
                    </div>
                    <p class="exp-hint" id="profile-exp-hint">다음 레벨까지 100 EXP 필요</p>
                </div>

                <!-- 통계 카드 -->
                <div class="stats-section">
                    <h4>📊 활동 기록</h4>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">⚔️</div>
                            <div class="stat-value" id="stat-battles">0</div>
                            <div class="stat-label">총 배틀</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">🏆</div>
                            <div class="stat-value" id="stat-wins">0</div>
                            <div class="stat-label">승리</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">🔴</div>
                            <div class="stat-value" id="stat-captures">0</div>
                            <div class="stat-label">포획</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">📖</div>
                            <div class="stat-value" id="stat-pokedex">0</div>
                            <div class="stat-label">도감</div>
                        </div>
                    </div>
                </div>

                <!-- 파티 미리보기 -->
                <div class="party-preview-section">
                    <h4>🐾 나의 파티</h4>
                    <div class="party-preview" id="party-preview">
                        <!-- 파티 몬스터들이 동적으로 추가됨 -->
                    </div>
                </div>

                <!-- 보유 자원 -->
                <div class="resources-section">
                    <h4>💰 보유 자원</h4>
                    <div class="resources-grid">
                        <div class="resource-item">
                            <span class="resource-icon">💰</span>
                            <span class="resource-value" id="resource-money">0</span>
                        </div>
                        <div class="resource-item">
                            <span class="resource-icon">🔴</span>
                            <span class="resource-value" id="resource-pokeball">0</span>
                        </div>
                        <div class="resource-item">
                            <span class="resource-icon">🔵</span>
                            <span class="resource-value" id="resource-greatball">0</span>
                        </div>
                        <div class="resource-item">
                            <span class="resource-icon">💛</span>
                            <span class="resource-value" id="resource-ultraball">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 파티 화면 -->
        <div id="party-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="goBack()">← 뒤로</button>
                <h2>🐾 내 파티</h2>
            </div>
            <div class="party-grid" id="party-grid">
                <!-- 파티 몬스터들이 동적으로 추가됨 -->
            </div>
            <h3>📦 보관함</h3>
            <div class="storage-grid" id="storage-grid">
                <!-- 보관함 몬스터들이 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 가방 화면 -->
        <div id="bag-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="goBack()">← 뒤로</button>
                <h2>🎒 가방</h2>
            </div>
            <div class="bag-grid" id="bag-grid">
                <!-- 아이템들이 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 몬스터 상세 정보 -->
        <div id="monster-detail" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="goBack()">← 뒤로</button>
                <h2 id="detail-name">몬스터 이름</h2>
            </div>
            <div class="monster-detail-content">
                <div class="detail-sprite" id="detail-sprite"></div>
                <div class="detail-info">
                    <p id="detail-type">속성: ???</p>
                    <p id="detail-rarity">희귀도: ???</p>
                    <p id="detail-description">설명...</p>
                    <div class="detail-stats" id="detail-stats">
                        <!-- 스탯들이 동적으로 추가됨 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 결과 화면 -->
        <div id="result-screen" class="screen">
            <div class="result-content">
                <h2 id="result-title">결과</h2>
                <p id="result-message">메시지</p>
                <div id="result-rewards"></div>
                <button onclick="returnToExplore()">확인</button>
            </div>
        </div>

        <!-- 로딩 오버레이 -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <p>로딩 중...</p>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="auth.js"></script>
    <script src="story.js"></script>
    <script src="game.js"></script>
</body>
</html>
